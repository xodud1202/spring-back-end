<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.xodud1202.springbackend.mapper.BoardMapper">
	<select id="getAdminBoardList" resultType="com.xodud1202.springbackend.domain.admin.board.BoardVO">
		/* BoardMapper.getAdminBoardList : 게시글 리스트 조회 */
		SELECT BI.BOARD_NO
		     , BI.BOARD_DIV_CD
		     , CD1.CD_NM AS BOARD_DIV_NM
		     , BI.BOARD_DETAIL_DIV_CD
		     , CD2.CD_NM AS BOARD_DETAIL_DIV_NM
		     , BI.TITLE
		     , BI.VIEW_YN
		     , BI.READ_CNT
		     , BI.REG_DT
		     , BI.UDT_DT
		  FROM BOARD_INFO BI
		  LEFT JOIN COMMON_CODE CD1
		    ON CD1.GRP_CD = 'BOARD_DIV'
		   AND CD1.CD = BI.BOARD_DIV_CD
		  LEFT JOIN COMMON_CODE CD2
		    ON CD2.GRP_CD = 'BOARD_DETAIL_DIV'
		   AND CD2.CD = BI.BOARD_DETAIL_DIV_CD
		 WHERE BI.DEL_YN = 'N'
		   AND BI.BOARD_DIV_CD = 'BOARD_DIV_12'
		<if test="boardDetailDivCd != null and boardDetailDivCd != ''">
		   AND BI.BOARD_DETAIL_DIV_CD = #{boardDetailDivCd}
		</if>
		<if test="title != null and title != ''">
		   AND BI.TITLE LIKE CONCAT('%', #{title}, '%')
		</if>
		 ORDER BY BI.BOARD_NO DESC
		 LIMIT #{pageSize} OFFSET #{offset}
	</select>

	<select id="getAdminBoardCount" resultType="int">
		/* BoardMapper.getAdminBoardCount : 게시글 리스트 조회 수 */
		SELECT COUNT(1)
		  FROM BOARD_INFO BI
		 WHERE BI.DEL_YN = 'N'
		   AND BI.BOARD_DIV_CD = 'BOARD_DIV_12'
		<if test="boardDetailDivCd != null and boardDetailDivCd != ''">
		   AND BI.BOARD_DETAIL_DIV_CD = #{boardDetailDivCd}
		</if>
		<if test="title != null and title != ''">
		   AND BI.TITLE LIKE CONCAT('%', #{title}, '%')
		</if>
	</select>

	<select id="getAdminBoardDetail" resultType="com.xodud1202.springbackend.domain.admin.board.BoardVO">
		/* BoardMapper.getAdminBoardDetail : 게시글 상세 조회 */
		SELECT BI.BOARD_NO
		     , BI.BOARD_DIV_CD
		     , CD1.CD_NM AS BOARD_DIV_NM
		     , BI.BOARD_DETAIL_DIV_CD
		     , CD2.CD_NM AS BOARD_DETAIL_DIV_NM
		     , BI.TITLE
		     , BI.CONTENT
		     , BI.VIEW_YN
		     , BI.READ_CNT
		     , BI.REG_DT
		     , BI.UDT_DT
		  FROM BOARD_INFO BI
		  LEFT JOIN COMMON_CODE CD1
		    ON CD1.GRP_CD = 'BOARD_DIV'
		   AND CD1.CD = BI.BOARD_DIV_CD
		  LEFT JOIN COMMON_CODE CD2
		    ON CD2.GRP_CD = 'BOARD_DETAIL_DIV'
		   AND CD2.CD = BI.BOARD_DETAIL_DIV_CD
		 WHERE BI.DEL_YN = 'N'
		   AND BI.BOARD_DIV_CD = 'BOARD_DIV_12'
		   AND BI.BOARD_NO = #{boardNo}
	</select>

	<update id="updateAdminBoard">
		/* BoardMapper.updateAdminBoard: 게시글 수정 */
		UPDATE BOARD_INFO
		   <set>
		   		<if test="boardDetailDivCd != null and boardDetailDivCd != ''">
		   			BOARD_DETAIL_DIV_CD = #{boardDetailDivCd},
		   		</if>
		   		<if test="title != null">
		   			TITLE = #{title},
		   		</if>
		   		<if test="content != null">
		   			CONTENT = #{content},
		   		</if>
		   		<if test="udtNo != null">
		   			UDT_NO = #{udtNo},
		   		</if>
		   		UDT_DT = NOW()
		   </set>
		 WHERE BOARD_NO = #{boardNo}
		   AND DEL_YN = 'N'
		   AND BOARD_DIV_CD = 'BOARD_DIV_12'
	</update>

	<insert id="insertAdminBoard">
		/* BoardMapper.insertAdminBoard: 게시글 등록 */
		INSERT INTO BOARD_INFO (
		       BOARD_DIV_CD
		     , BOARD_DETAIL_DIV_CD
		     , TITLE
		     , CONTENT
		     , VIEW_YN
		     , READ_CNT
		     , DEL_YN
		     , REG_NO
		     , UDT_NO
		     , REG_DT
		     , UDT_DT
		) VALUES (
		       'BOARD_DIV_12'
		     , #{boardDetailDivCd}
		     , #{title}
		     , #{content}
		     , 'Y'
		     , 0
		     , 'N'
		     , #{regNo}
		     , #{udtNo}
		     , NOW()
		     , NOW()
		)
	</insert>

	<update id="deleteAdminBoard">
		/* BoardMapper.deleteAdminBoard: 게시글 삭제 */
		UPDATE BOARD_INFO
		   SET DEL_YN = 'Y'
		     , UDT_NO = #{udtNo}
		     , UDT_DT = NOW()
		 WHERE BOARD_NO = #{boardNo}
		   AND DEL_YN = 'N'
		   AND BOARD_DIV_CD = 'BOARD_DIV_12'
	</update>
</mapper>
